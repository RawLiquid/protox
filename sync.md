#Device Sync
Trying to figure out how the initial sync works.

So far, the remote transmits the same packet with byte 0 being a 0x01 and seemingly random 5 bytes following.
The quad responds with the same packet, but with a 0x02 for byte 0. They then do 0x03 and 0x04.

The quad ID, which comes in bytes 2-5 of the received packet is set as the new remote ID.

After that, the remote goes back to 0x01 (same as before.) The quad responds with 0x02 again, but this time has 0x03 and 0x07 in bytes 6 and 7 respectively. 

The remote replies with the original packet, but this time byte 0 is 0x09 and byte 2 is 0x00. The quad then replies to that with byte 0 as 0x0a and byte 1 as 0x01.

They go back an forth incrementing that number. The remote increments byte 2 while the quad increments byte 1. Once they both reach 0x09, encryption is enabled by writing 0xF to the Code Register I (register 0x1F). 

After that the syncing process seems to be complete and the remote starts sending the normal control packet (with byte 0 of 0x20)

## Packet Format(s)

### Stage 1

Byte | Description
---- | -----------
0x00 | Packet Type - (0x1, 0x2, 0x3, 0x4)
0x01 | counter (both)
0x02 | Remote ID[0]
0x03 | Remote ID[1]
0x04 | Remote ID[2]
0x05 | Remote ID[3]
0x06 | ?
0x07 | ?
0x08 | ?
0x09 | ?
0x0A | ?
0x0B | ?
0x0C | ?
0x0D | ?
0x0E | ?
0x0F | Checksum


### Stage 2

Byte | Description
---- | -----------
0x00 | Packet Type - (0x1, 0x2, 0x3, 0x4)
0x01 | counter (both)
0x02 | Remote ID[0]
0x03 | Remote ID[1]
0x04 | Remote ID[2]
0x05 | Remote ID[3]
0x06 | 0x3 (remote)
0x07 | 0x7 (remote)
0x08 | ?
0x09 | ?
0x0A | ?
0x0B | ?
0x0C | ?
0x0D | ?
0x0E | ?
0x0F | Checksum

### Stage 3

Byte | Description
---- | -----------
0x00 | Packet Type - (0xA, 0x9)
0x01 | Quad Counter (starts at 1)
0x02 | Remote Counter (starts at 0)
0x03 | ?
0x04 | ?
0x05 | ?
0x06 | 0x3 (remote)
0x07 | 0x7 (remote)
0x08 | ?
0x09 | ?
0x0A | ?
0x0B | ?
0x0C | ?
0x0D | ?
0x0E | ?
0x0F | Checksum

##Sync captures

The first byte in the capture is the A7105 register, so it's not part of the data. 0x05 is FIFO write (so TX) and 0x45 is FIFO read (so RX)

###File: withquad-goodcs.csv
```
05 01 82 96 d5 18 f6 00 00 00 00 00 00 00 00 00 04 
05 01 82 96 d5 18 f6 00 00 00 00 00 00 00 00 00 04 
05 01 82 96 d5 18 f6 00 00 00 00 00 00 00 00 00 04 
45 02 82 96 d5 18 f6 00 00 00 00 00 00 00 00 00 03 
05 03 82 96 d5 18 f6 00 00 00 00 00 00 00 00 00 02 
45 04 82 96 d5 18 f6 00 00 00 00 00 00 00 00 00 01 
05 01 82 96 d5 18 f6 00 00 00 00 00 00 00 00 00 04 
45 02 82 96 d5 18 f6 03 07 00 00 00 00 00 00 00 f9 
05 09 82 00 d5 18 f6 00 00 00 00 00 00 00 00 00 92 
45 0a 01 96 d5 18 f6 03 07 00 00 00 00 00 00 00 72 
05 09 82 01 d5 18 f6 00 00 00 00 00 00 00 00 00 91 
45 0a 02 96 d5 18 f6 03 07 00 00 00 00 00 00 00 71 
05 09 82 02 d5 18 f6 00 00 00 00 00 00 00 00 00 90 
45 0a 03 96 d5 18 f6 03 07 00 00 00 00 00 00 00 70 
05 09 82 03 d5 18 f6 00 00 00 00 00 00 00 00 00 8f 
45 0a 04 96 d5 18 f6 03 07 00 00 00 00 00 00 00 6f 
05 09 82 04 d5 18 f6 00 00 00 00 00 00 00 00 00 8e 
45 0a 05 96 d5 18 f6 03 07 00 00 00 00 00 00 00 6e 
05 09 82 05 d5 18 f6 00 00 00 00 00 00 00 00 00 8d 
45 0a 06 96 d5 18 f6 03 07 00 00 00 00 00 00 00 6d 
05 09 82 06 d5 18 f6 00 00 00 00 00 00 00 00 00 8c 
45 0a 07 96 d5 18 f6 03 07 00 00 00 00 00 00 00 6c 
05 09 82 07 d5 18 f6 00 00 00 00 00 00 00 00 00 8b 
45 0a 08 96 d5 18 f6 03 07 00 00 00 00 00 00 00 6b 
05 09 82 08 d5 18 f6 00 00 00 00 00 00 00 00 00 8a 
45 0a 09 96 d5 18 f6 03 07 00 00 00 00 00 00 00 6a 
05 09 82 09 d5 18 f6 00 00 00 00 00 00 00 00 00 89 
05 20 00 00 00 80 00 6c 00 80 06 19 00 00 00 00 55 
05 20 00 00 00 80 00 6c 00 80 06 19 00 00 00 00 55 
05 20 00 00 00 80 00 6c 00 80 06 19 00 00 00 00 55 
```

###File: UDLR-RRLL-TUTD.csv
```
05 01 78 6a a1 a0 0b 00 00 00 00 00 00 00 00 00 d1 
05 01 78 6a a1 a0 0b 00 00 00 00 00 00 00 00 00 d1 
05 01 78 6a a1 a0 0b 00 00 00 00 00 00 00 00 00 d1 
05 01 78 6a a1 a0 0b 00 00 00 00 00 00 00 00 00 d1 
05 01 78 6a a1 a0 0b 00 00 00 00 00 00 00 00 00 d1 
45 02 78 6a a1 a0 0b 00 00 00 00 00 00 00 00 00 d0 
05 03 78 6a a1 a0 0b 00 00 00 00 00 00 00 00 00 cf 
45 04 78 6a a1 a0 0b 00 00 00 00 00 00 00 00 00 ce 
05 01 78 6a a1 a0 0b 00 00 00 00 00 00 00 00 00 d1 
45 02 78 6a a1 a0 0b 03 07 00 00 00 00 00 00 00 c6 
05 09 78 00 a1 a0 0b 00 00 00 00 00 00 00 00 00 33 
45 0a 01 6a a1 a0 0b 03 07 00 00 00 00 00 00 00 35 
05 09 78 01 a1 a0 0b 00 00 00 00 00 00 00 00 00 32 
45 0a 02 6a a1 a0 0b 03 07 00 00 00 00 00 00 00 34 
05 09 78 02 a1 a0 0b 00 00 00 00 00 00 00 00 00 31 
45 0a 03 6a a1 a0 0b 03 07 00 00 00 00 00 00 00 33 
05 09 78 03 a1 a0 0b 00 00 00 00 00 00 00 00 00 30 
45 0a 04 6a a1 a0 0b 03 07 00 00 00 00 00 00 00 32 
05 09 78 04 a1 a0 0b 00 00 00 00 00 00 00 00 00 2f 
45 0a 05 6a a1 a0 0b 03 07 00 00 00 00 00 00 00 31 
05 09 78 05 a1 a0 0b 00 00 00 00 00 00 00 00 00 2e 
45 0a 06 6a a1 a0 0b 03 07 00 00 00 00 00 00 00 30 
05 09 78 06 a1 a0 0b 00 00 00 00 00 00 00 00 00 2d 
45 0a 07 6a a1 a0 0b 03 07 00 00 00 00 00 00 00 2f 
05 09 78 07 a1 a0 0b 00 00 00 00 00 00 00 00 00 2c 
45 0a 08 6a a1 a0 0b 03 07 00 00 00 00 00 00 00 2e 
05 09 78 08 a1 a0 0b 00 00 00 00 00 00 00 00 00 2b 
45 0a 09 6a a1 a0 0b 03 07 00 00 00 00 00 00 00 2d 
05 09 78 09 a1 a0 0b 00 00 00 00 00 00 00 00 00 2a 
05 20 00 00 00 80 00 6c 00 80 06 19 00 00 00 00 55 
05 20 00 00 00 80 00 6c 00 80 06 19 00 00 00 00 55 
```

###File: connect1.csv
```
05 01 5a ba e0 78 54 00 00 00 00 00 00 00 00 00 3f 
05 01 5a ba e0 78 54 00 00 00 00 00 00 00 00 00 3f 
05 01 5a ba e0 78 54 00 00 00 00 00 00 00 00 00 3f 
05 01 5a ba e0 78 54 00 00 00 00 00 00 00 00 00 3f 
45 02 5a ba e0 78 54 00 00 00 00 00 00 00 00 00 3e 
05 03 5a ba e0 78 54 00 00 00 00 00 00 00 00 00 3d 
45 04 5a ba e0 78 54 00 00 00 00 00 00 00 00 00 3c 
05 01 5a ba e0 78 54 00 00 00 00 00 00 00 00 00 3f 
45 02 5a ba e0 78 54 03 07 00 00 00 00 00 00 00 34 
05 09 5a 00 e0 78 54 00 00 00 00 00 00 00 00 00 f1 
45 0a 01 ba e0 78 54 03 07 00 00 00 00 00 00 00 85 
05 09 5a 01 e0 78 54 00 00 00 00 00 00 00 00 00 f0 
45 0a 02 ba e0 78 54 03 07 00 00 00 00 00 00 00 84 
05 09 5a 02 e0 78 54 00 00 00 00 00 00 00 00 00 ef 
45 0a 03 ba e0 78 54 03 07 00 00 00 00 00 00 00 83 
05 09 5a 03 e0 78 54 00 00 00 00 00 00 00 00 00 ee 
45 0a 04 ba e0 78 54 03 07 00 00 00 00 00 00 00 82 
05 09 5a 04 e0 78 54 00 00 00 00 00 00 00 00 00 ed 
45 0a 05 ba e0 78 54 03 07 00 00 00 00 00 00 00 81 
05 09 5a 05 e0 78 54 00 00 00 00 00 00 00 00 00 ec 
45 0a 06 ba e0 78 54 03 07 00 00 00 00 00 00 00 80 
05 09 5a 06 e0 78 54 00 00 00 00 00 00 00 00 00 eb 
45 0a 07 ba e0 78 54 03 07 00 00 00 00 00 00 00 7f 
05 09 5a 07 e0 78 54 00 00 00 00 00 00 00 00 00 ea 
45 0a 08 ba e0 78 54 03 07 00 00 00 00 00 00 00 7e 
05 09 5a 08 e0 78 54 00 00 00 00 00 00 00 00 00 e9 
45 0a 09 ba e0 78 54 03 07 00 00 00 00 00 00 00 7d 
05 09 5a 09 e0 78 54 00 00 00 00 00 00 00 00 00 e8 
05 20 00 00 00 80 00 6c 00 80 06 19 00 00 00 00 55 
05 20 00 00 00 80 00 6c 00 80 06 19 00 00 00 00 55 
05 20 00 00 00 80 00 6c 00 80 06 19 00 00 00 00 55 
```

###File: connect2.csv
```
05 01 82 c0 ac d8 41 00 00 00 00 00 00 00 00 00 f8 
05 01 82 c0 ac d8 41 00 00 00 00 00 00 00 00 00 f8 
05 01 82 c0 ac d8 41 00 00 00 00 00 00 00 00 00 f8 
45 02 82 c0 ac d8 41 00 00 00 00 00 00 00 00 00 f7 
05 03 82 c0 ac d8 41 00 00 00 00 00 00 00 00 00 f6 
45 04 82 c0 ac d8 41 00 00 00 00 00 00 00 00 00 f5 
05 01 82 c0 ac d8 41 00 00 00 00 00 00 00 00 00 f8 
45 02 82 c0 ac d8 41 03 07 00 00 00 00 00 00 00 ed 
05 09 82 00 ac d8 41 00 00 00 00 00 00 00 00 00 b0 
45 0a 01 c0 ac d8 41 03 07 00 00 00 00 00 00 00 66 
05 09 82 01 ac d8 41 00 00 00 00 00 00 00 00 00 af 
45 0a 02 c0 ac d8 41 03 07 00 00 00 00 00 00 00 65 
05 09 82 02 ac d8 41 00 00 00 00 00 00 00 00 00 ae 
45 0a 03 c0 ac d8 41 03 07 00 00 00 00 00 00 00 64 
05 09 82 03 ac d8 41 00 00 00 00 00 00 00 00 00 ad 
45 0a 04 c0 ac d8 41 03 07 00 00 00 00 00 00 00 63 
05 09 82 04 ac d8 41 00 00 00 00 00 00 00 00 00 ac 
45 0a 05 c0 ac d8 41 03 07 00 00 00 00 00 00 00 62 
05 09 82 05 ac d8 41 00 00 00 00 00 00 00 00 00 ab 
45 0a 06 c0 ac d8 41 03 07 00 00 00 00 00 00 00 61 
05 09 82 06 ac d8 41 00 00 00 00 00 00 00 00 00 aa 
45 0a 07 c0 ac d8 41 03 07 00 00 00 00 00 00 00 60 
05 09 82 07 ac d8 41 00 00 00 00 00 00 00 00 00 a9 
45 0a 08 c0 ac d8 41 03 07 00 00 00 00 00 00 00 5f 
05 09 82 08 ac d8 41 00 00 00 00 00 00 00 00 00 a8 
45 0a 09 c0 ac d8 41 03 07 00 00 00 00 00 00 00 5e 
05 09 82 09 ac d8 41 00 00 00 00 00 00 00 00 00 a7 
05 20 00 00 00 80 00 6c 00 80 06 19 00 00 00 00 55 
05 20 00 00 00 80 00 6c 00 80 06 19 00 00 00 00 55 
05 20 00 00 00 80 00 6c 00 80 06 19 00 00 00 00 55 
```

###File: connect3.csv
This one seems to have failed initially then recovered
```
05 01 82 a0 4d 08 5f 00 00 00 00 00 00 00 00 00 29 
05 01 82 a0 4d 08 5f 00 00 00 00 00 00 00 00 00 29 
05 01 82 a0 4d 08 5f 00 00 00 00 00 00 00 00 00 29 
45 02 82 a0 4d 08 5f 00 00 00 00 00 00 00 00 00 28 
05 03 82 a0 4d 08 5f 00 00 00 00 00 00 00 00 00 27 
45 04 82 a0 4d 08 5f 30 00 01 a5 80 20 00 00 00 26 
05 03 82 a0 4d 08 5f 00 00 00 00 00 00 00 00 00 27 
05 03 82 a0 4d 08 5f 00 00 00 00 00 00 00 00 00 27 
05 03 82 a0 4d 08 5f 00 00 00 00 00 00 00 00 00 27 
05 03 82 a0 4d 08 5f 00 00 00 00 00 00 00 00 00 27 
05 03 82 a0 4d 08 5f 00 00 00 00 00 00 00 00 00 27 
05 03 82 a0 4d 08 5f 00 00 00 00 00 00 00 00 00 27 
05 03 82 a0 4d 08 5f 00 00 00 00 00 00 00 00 00 27 
05 03 82 a0 4d 08 5f 00 00 00 00 00 00 00 00 00 27 
05 03 82 a0 4d 08 5f 00 00 00 00 00 00 00 00 00 27 
05 03 82 a0 4d 08 5f 00 00 00 00 00 00 00 00 00 27 
05 01 82 a0 4d 08 5f 00 00 00 00 00 00 00 00 00 29 
05 01 82 a0 4d 08 5f 00 00 00 00 00 00 00 00 00 29 
05 01 82 a0 4d 08 5f 00 00 00 00 00 00 00 00 00 29 
05 01 82 a0 4d 08 5f 00 00 00 00 00 00 00 00 00 29 
05 01 82 a0 4d 08 5f 00 00 00 00 00 00 00 00 00 29 
05 01 82 a0 4d 08 5f 00 00 00 00 00 00 00 00 00 29 
05 01 82 a0 4d 08 5f 00 00 00 00 00 00 00 00 00 29 
05 01 82 a0 4d 08 5f 00 00 00 00 00 00 00 00 00 29 
05 01 82 a0 4d 08 5f 00 00 00 00 00 00 00 00 00 29 
05 01 82 a0 4d 08 5f 00 00 00 00 00 00 00 00 00 29 
05 01 82 a0 4d 08 5f 00 00 00 00 00 00 00 00 00 29 
05 01 82 a0 4d 08 5f 00 00 00 00 00 00 00 00 00 29 
05 01 82 a0 4d 08 5f 00 00 00 00 00 00 00 00 00 29 
05 01 82 a0 4d 08 5f 00 00 00 00 00 00 00 00 00 29 
05 01 82 a0 4d 08 5f 00 00 00 00 00 00 00 00 00 29 
45 02 82 a0 4d 08 5f 00 00 00 00 00 00 00 00 00 28 
05 03 82 a0 4d 08 5f 00 00 00 00 00 00 00 00 00 27 
45 04 82 a0 4d 08 5f 00 00 00 00 00 00 00 00 00 26 
05 01 82 a0 4d 08 5f 00 00 00 00 00 00 00 00 00 29 
45 02 82 a0 4d 08 5f 03 07 00 00 00 00 00 00 00 1e 
05 09 82 00 4d 08 5f 00 00 00 00 00 00 00 00 00 c1 
45 0a 01 a0 4d 08 5f 03 07 00 00 00 00 00 00 00 97 
05 09 82 01 4d 08 5f 00 00 00 00 00 00 00 00 00 c0 
45 0a 02 a0 4d 08 5f 03 07 00 00 00 00 00 00 00 96 
05 09 82 02 4d 08 5f 00 00 00 00 00 00 00 00 00 bf 
45 0a 03 a0 4d 08 5f 03 07 00 00 00 00 00 00 00 95 
05 09 82 03 4d 08 5f 00 00 00 00 00 00 00 00 00 be 
45 0a 04 a0 4d 08 5f 03 07 00 00 00 00 00 00 00 94 
05 09 82 04 4d 08 5f 00 00 00 00 00 00 00 00 00 bd 
45 0a 05 a0 4d 08 5f 03 07 00 00 00 00 00 00 00 93 
05 09 82 05 4d 08 5f 00 00 00 00 00 00 00 00 00 bc 
45 0a 06 a0 4d 08 5f 03 07 00 00 20 00 08 18 01 92 
05 09 82 05 4d 08 5f 00 00 00 00 00 00 00 00 00 bc 
45 0a 07 a0 4d 08 5f 03 07 00 00 00 00 00 00 00 91 
05 09 82 06 4d 08 5f 00 00 00 00 00 00 00 00 00 bb 
45 0a 08 a0 4d 08 5f 03 07 00 00 00 00 00 00 00 90 
05 09 82 07 4d 08 5f 00 00 00 00 00 00 00 00 00 ba 
45 0a 09 a0 4d 08 5f 03 07 00 00 00 00 00 00 00 8f 
05 09 82 08 4d 08 5f 00 00 00 00 00 00 00 00 00 b9 
05 20 00 00 00 80 00 6c 00 80 06 19 00 00 00 00 55 
05 20 00 00 00 80 00 6c 00 80 06 19 00 00 00 00 55 
```
